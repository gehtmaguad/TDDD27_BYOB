!function(){function o(o,t){o.when("/",{templateUrl:"/locationlist/locationlist.view.html",controller:"locationlistCtrl",controllerAs:"vm"}).when("/location/:locationid",{templateUrl:"/locationdetail/locationdetail.view.html",controller:"locationdetailCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"/about/about.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),t.html5Mode({enabled:!0,requireBase:!1})}angular.module("byobApp",["ngRoute","ui.bootstrap"]),angular.module("byobApp").config(["$routeProvider","$locationProvider",o])}(),function(){function o(){var o=this;o.header="About",o.content="This is the about page with \n\n a description of the service"}angular.module("byobApp").controller("aboutCtrl",o)}(),function(){function o(o,t){var e=this;e.formerror="",e.formdata={email:"",pwd:""},e.returnpage="/",e.onSubmit=function(){return e.formdata.email&&e.formdata.pwd?void t.login(e.formdata).error(function(o){e.formerror=o}).then(function(){o.path(e.returnpage)}):(e.formerror="Please fill out fields",!1)}}angular.module("byobApp").controller("loginCtrl",o),o.$inject=["$location","authService"]}(),function(){function o(o,t){var e=this;e.formerror="",e.formdata={username:"",email:"",pwd:""},e.returnpage="/",e.onSubmit=function(){return e.formdata.username&&e.formdata.email&&e.formdata.pwd?void t.register(e.formdata).error(function(o){e.formerror=o}).then(function(){o.path(e.returnpage)}):(e.formerror="Please fill out fields",!1)}}angular.module("byobApp").controller("registerCtrl",o),o.$inject=["$location","authService"]}(),function(){function o(o,t,e){var n=this;n.locationdata=e,n.formdata="",n.modal={close:function(t){o.close(t)},cancel:function(){o.dismiss("cancel")}},n.onSubmit=function(){return n.formerror="",n.formdata.text?(t.addCommentById(n.locationdata.id,{text:n.formdata.text}).success(function(o){n.modal.close(o)}).error(function(o){n.formerror=o}),!1):(n.formerror="Please fill out comment field",!1)}}angular.module("byobApp").controller("createCommentModalCtrl",o),o.$inject=["$uibModalInstance","commentService","locationdata"]}(),function(){function o(o,t){var e=this;e.formdata="",e.modal={close:function(t){o.close(t)},cancel:function(){o.dismiss("cancel")}},e.onSubmit=function(){return e.formerror="",e.formdata.theme&&e.formdata.address&&e.formdata.datum?(t.addLocation({theme:e.formdata.theme,datum:e.formdata.datum,address:e.formdata.address,afterwards:e.formdata.afterwards}).success(function(o){e.modal.close(o)}).error(function(o){e.formerror=o}),!1):(e.formerror="Please fill out fields",!1)}}angular.module("byobApp").controller("createLocationModalCtrl",o),o.$inject=["$uibModalInstance","locationService"]}(),function(){function o(o,t,e){var n=this;n.locationdata=e,n.formdata="",n.modal={close:function(t){o.close(t)},cancel:function(){o.dismiss("cancel")}},n.onSubmit=function(){return t.deleteCommentById(n.locationdata.locationid,n.locationdata.commentid).success(function(o){n.modal.close(o)}).error(function(o){n.formerror=o}),!1}}angular.module("byobApp").controller("deleteCommentModalCtrl",o),o.$inject=["$uibModalInstance","commentService","locationdata"]}(),function(){function o(o,t,e){var n=this;n.locationdata=e,n.formdata="",n.modal={close:function(t){o.close(t)},cancel:function(){o.dismiss("cancel")}},n.onSubmit=function(){return t.deleteLocationById(n.locationdata.locationid).success(function(o){n.modal.close(o)}).error(function(o){n.formerror=o}),!1}}angular.module("byobApp").controller("deleteLocationModalCtrl",o),o.$inject=["$uibModalInstance","locationService","locationdata"]}(),function(){function o(o,t,e,n){var r=this;r.isLoggedIn=n.isLoggedIn(),r.currentUser=n.currentUser(),e.getLocationDetailById(o.locationid).success(function(o){r.location=o,r.location.mapUrl="http://maps.googleapis.com/maps/api/staticmap?center=          "+r.location.coords[1]+","+r.location.coords[0]+"&zoom=17&size=400x350&sensor=false&markers=          "+r.location.coords[1]+","+r.location.coords[0]+"&scale=2"}).error(function(o){r.error="Sorry, an error occurred. Please try again later!",console.log(o)}),r.createCommentModal=function(){var o=t.open({templateUrl:"/createCommentModal/createCommentModal.view.html",controller:"createCommentModalCtrl as vm",resolve:{locationdata:function(){return{id:r.location._id,theme:r.location.theme}}}});o.result.then(function(o){r.location.comments.push(o)})},r.deleteComment=function(o,e){var n=t.open({templateUrl:"/deleteCommentModal/deleteCommentModal.view.html",controller:"deleteCommentModalCtrl as vm",resolve:{locationdata:function(){return{locationid:o,commentid:e}}}});n.result.then(function(o){r.location.comments=r.location.comments.filter(function(t){return t._id!==o._id})})},r.updateComment=function(o){var e=t.open({templateUrl:"/updateCommentModal/updateCommentModal.view.html",controller:"updateCommentModalCtrl as vm",resolve:{locationdata:function(){return{id:r.location._id,theme:r.location.theme,comment:o}}}});e.result.then(function(o){r.location.comments=r.location.comments.filter(function(t){return t._id!==o._id}),r.location.comments.push(o)})}}angular.module("byobApp").controller("locationdetailCtrl",o),o.$inject=["$routeParams","$uibModal","locationService","authService"]}(),function(){function o(o,t,e,n,r){var a=this;a.loading="true",a.isLoggedIn=r.isLoggedIn(),a.currentUser=r.currentUser(),a.locations="",a.createLocationModal=function(){var o=t.open({templateUrl:"/createLocationModal/createLocationModal.view.html",controller:"createLocationModalCtrl as vm"});o.result.then(function(o){a.locations.push(o)})},a.deleteLocationModal=function(o){var e=t.open({templateUrl:"/deleteLocationModal/deleteLocationModal.view.html",controller:"deleteLocationModalCtrl as vm",resolve:{locationdata:function(){return{locationid:o}}}});e.result.then(function(o){a.locations=a.locations.filter(function(t){return t._id!==o._id})})},a.updateLocationModal=function(o){var e=t.open({templateUrl:"/updateLocationModal/updateLocationModal.view.html",controller:"updateLocationModalCtrl as vm",resolve:{locationdata:function(){return{location:o}}}});e.result.then(function(o){a.locations=a.locations.filter(function(t){return t._id!==o._id}),a.locations.push(o)})},a.errorFunc=function(t){o.$apply(function(){a.error=t.message,a.loading=""})},a.noSupportFunc=function(){o.$apply(function(){a.error="Geolocation not supported by this browser",a.loading=""})},a.successFunc=function(o){var t=o.coords.latitude,n=o.coords.longitude;e.getLocationsByCoordinates(t,n,1e5,10).success(function(o){a.locations=o,a.loading=""}).error(function(o){a.error="Sorry, an error occurred. Please try again later!",a.loading=""})},n.getPosition(a.successFunc,a.errorFunc,a.noSupportFunc)}angular.module("byobApp").controller("locationlistCtrl",o),o.$inject=["$scope","$uibModal","locationService","coordinatesService","authService"]}(),function(){function o(o,t){var e=function(t){o.localStorage.byobToken=t},n=function(){return o.localStorage.byobToken},r=function(o){return t.post("/api/login",o).success(function(o){e(o.token)})};logout=function(){o.localStorage.removeItem("byobToken")};var a=function(o){return t.post("/api/register",o).success(function(o){e(o.token)})},i=function(){var t=n();if(!t)return!1;var e=JSON.parse(o.atob(t.split(".")[1]));return e.exp>Date.now()/1e3},c=function(){if(!i())return!1;var t=n(),e=JSON.parse(o.atob(t.split(".")[1]));return{email:e.email,username:e.username}};return{setToken:e,getToken:n,login:r,logout:logout,register:a,isLoggedIn:i,currentUser:c}}angular.module("byobApp").service("authService",o),o.$inject=["$window","$http"]}(),function(){function o(o,t){var e=function(e,n){return o.post("/api/locations/"+e+"/comments",n,{headers:{Authorization:"Bearer "+t.getToken()}})},n=function(e,n){return o["delete"]("/api/locations/"+e+"/comments/"+n,{headers:{Authorization:"Bearer "+t.getToken()}})},r=function(e,n,r){return o.put("/api/locations/"+e+"/comments/"+n,r,{headers:{Authorization:"Bearer "+t.getToken()}})};return{addCommentById:e,deleteCommentById:n,updateCommentById:r}}angular.module("byobApp").service("commentService",o),o.$inject=["$http","authService"]}(),function(){function o(){var o=function(o,t,e){navigator.geolocation?navigator.geolocation.getCurrentPosition(o,t):e()};return{getPosition:o}}angular.module("byobApp").service("coordinatesService",o)}(),function(){function o(){return function(o){return o>=1e3?parseInt(o/1e3)+" km":parseInt(o)+" m"}}angular.module("byobApp").filter("filterDistance",o)}(),function(){function o(){return{restrict:"EA",templateUrl:"/shared/footer.directive.html"}}angular.module("byobApp").directive("byobFooter",o)}(),function(){function o(o,t){var e=function(t,e,n,r){return o.get("/api/locations?longitude="+e+"&latitude="+t+"&distance="+n+"&maxElements="+r)},n=function(t){return o.get("/api/locations/"+t)},r=function(e){return o.post("/api/locations",e,{headers:{Authorization:"Bearer "+t.getToken()}})},a=function(e){return o["delete"]("/api/locations/"+e,{headers:{Authorization:"Bearer "+t.getToken()}})},i=function(e,n){return o.put("/api/locations/"+e,n,{headers:{Authorization:"Bearer "+t.getToken()}})};return{getLocationsByCoordinates:e,getLocationDetailById:n,addLocation:r,deleteLocationById:a,updateLocation:i}}angular.module("byobApp").service("locationService",o),o.$inject=["$http","authService"]}(),function(){function o(o,t,e){var n=this;n.isLoggedIn=e.isLoggedIn(),n.currentUser=e.currentUser(),n.logout=function(){e.logout(),n.isLoggedIn=e.isLoggedIn()}}angular.module("byobApp").controller("navigationCtrl",o),o.$inject=["$location","$uibModal","authService"]}(),function(){function o(){return{restrict:"EA",templateUrl:"/shared/navigation.directive.html",controller:"navigationCtrl as navigationvm"}}angular.module("byobApp").directive("byobNavigation",o)}(),function(){function o(o,t,e){var n=this;n.locationdata=e,n.formdata={},n.formdata.author=e.comment.author,n.formdata.text=e.comment.text,n.modal={close:function(t){o.close(t)},cancel:function(){o.dismiss("cancel")}},n.onSubmit=function(){return n.formerror="",n.formdata.text?(t.updateCommentById(n.locationdata.id,n.locationdata.comment._id,{text:n.formdata.text}).success(function(o){n.modal.close(o)}).error(function(o){n.formerror="Problem salving comment "+o}),!1):(n.formerror="Please fill out comment field",!1)}}angular.module("byobApp").controller("updateCommentModalCtrl",o),o.$inject=["$uibModalInstance","commentService","locationdata"]}(),function(){function o(o,t,e){var n=this;n.locationdata=e,n.formdata={},n.formdata.theme=e.location.theme,n.formdata.address=e.location.address,n.formdata.datum=e.location.datum,n.formdata.afterwards=e.location.afterwards,n.modal={close:function(t){o.close(t)},cancel:function(){o.dismiss("cancel")}},n.onSubmit=function(){return n.formerror="",n.formdata.theme&&n.formdata.address&&n.formdata.datum?(t.updateLocation(n.locationdata.location._id,{theme:n.formdata.theme,address:n.formdata.address,datum:n.formdata.datum,afterwards:n.formdata.afterwards}).success(function(o){n.modal.close(o)}).error(function(o){n.formerror=o}),!1):(n.formerror="Please fill out fields",!1)}}angular.module("byobApp").controller("updateLocationModalCtrl",o),o.$inject=["$uibModalInstance","locationService","locationdata"]}();